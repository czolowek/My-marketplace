<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•ö –Ø–π—Ü–æ –ú–∞—Ä–∫–µ—Ç - by —è–π—Ü–æ –≥–ª–µ–±–∞</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container text-center">
            <h1>ü•ö –Ø–π—Ü–æ –ú–∞—Ä–∫–µ—Ç</h1>
            <p>by —è–π—Ü–æ –≥–ª–µ–±–∞ ‚Äî —Ç–≤–æ–π –ª–∏—á–Ω—ã–π –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å</p>
            <a href="{{ url_for('add_product') }}" class="btn btn-primary">
                –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
            </a>
        </div>
    </header>

    <!-- Products Section -->
    <section class="products-section">
        <div class="container">
            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'success' if category == 'success' else 'danger' if category == 'error' else 'warning' }}">
                            {{ message }}
                            <button class="btn-close" onclick="this.parentElement.remove()">&times;</button>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            {% if products %}
                <div class="products-grid">
                    {% for product in products %}
                        <div class="product-card" onclick="window.location.href='{{ url_for('product_detail', product_id=product.id) }}'">
                            {% if product.images %}
                                <div class="product-images">
                                    <div class="image-gallery">
                                        {% for image in product.images[:5] %}
                                            <img src="/docs/images/{{ image.filename }}" 
                                                 class="gallery-image {% if loop.first %}active{% endif %}" 
                                                 alt="{{ product.title }}">
                                        {% endfor %}
                                    </div>
                                    {% if product.images|length > 1 %}
                                        <div class="gallery-nav">
                                            <button class="nav-btn nav-prev" onclick="event.stopPropagation(); previousImage(this)">
                                                <i class="fas fa-chevron-left"></i>
                                            </button>
                                            <button class="nav-btn nav-next" onclick="event.stopPropagation(); nextImage(this)">
                                                <i class="fas fa-chevron-right"></i>
                                            </button>
                                        </div>
                                        <div class="image-counter">
                                            <span>1</span> / {{ product.images|length }}
                                        </div>
                                    {% endif %}
                                </div>
                            {% else %}
                                <div class="product-image-placeholder">
                                    <i class="fas fa-image"></i>
                                </div>
                            {% endif %}
                            
                            <div class="product-body">
                                <h3 class="product-title">{{ product.title }}</h3>
                                <p class="product-description">
                                    {{ product.description[:120] }}{% if product.description|length > 120 %}...{% endif %}
                                </p>
                                <div class="product-footer">
                                    <span class="product-price">{{ product.price }}</span>
                                    <button class="btn btn-success" onclick="event.stopPropagation(); showContactModal()">
                                        –ö—É–ø–∏—Ç—å
                                    </button>
                                </div>
                                <div class="product-date">
                                    {{ product.created_at.strftime('%d.%m.%Y') }}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">üõí</div>
                    <h2 class="empty-title">–ü–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</h2>
                    <p class="empty-description">–°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –¥–æ–±–∞–≤–∏—Ç —Ç–æ–≤–∞—Ä –≤ –Ω–∞—à –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å!</p>
                    <a href="{{ url_for('add_product') }}" class="btn btn-primary">
                        –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä
                    </a>
                </div>
            {% endif %}
        </div>
    </section>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal d-none">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">–°–≤—è–∑–∞—Ç—å—Å—è —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º</h3>
                <button class="btn-close" onclick="hideContactModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏:</p>
                <div class="contact-buttons">
                    <a href="https://wa.me/48793194133" class="btn btn-success" target="_blank">
                        <i class="fab fa-whatsapp"></i> WhatsApp: +48 793 194 133
                    </a>
                    <button class="btn btn-primary" onclick="copyDiscord()">
                        <i class="fab fa-discord"></i> Discord: nedavaitebanprostotak
                    </button>
                </div>
                <p class="mt-2" style="font-size: 0.875rem; color: var(--text-muted);">
                    Discord ID –±—É–¥–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
                </p>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='style.js') }}"></script>
</body>
</html>
